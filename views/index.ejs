<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <style>
        ul li span {
            margin-left: 8px;
            font-size: 12px;
            color: #a9a9a9;
        }
    </style>
</head>
<body>
<form>
    <input type="text" id="name" name="name" placeholder="name"/>
    <input type="text" id="note" name="note" placeholder="add note..."/>
    <input type="button" id="addBtn" value="add"/>
</form>
<div id="list"></div>
<script>
    $(function () {
        // list
        var $list = $('#list');
        $.ajax({
            url: '/todos',
            method: 'get',
            success: function (list) {
                if (list.length) {
                    var $ul = $('<ul>');
                    for (var i in list) {
                        var $li = $('<li>');
                        $li.append(
                                list[i].name,
                                $('<span>').text(list[i].note),
                                $('<input type="button" class="del" value="delete">')
                        ).attr('data-id',list[i]._id);
                        $ul.append($li);
                    }
                    $list.append($ul);
                }
                else {
                    var $p = $('<p>暂无记录</p>');
                    $list.append($p);
                }
            }
        });

        $list.on('click', '.del', function () {
            var id = $(this).parents('li').data('id');
            var params = {
                id:id
            };
            $.ajax({
                url: '/todos',
                method: 'delete',
                data: params,
                success: function (r) {
                    alert('删除成功');
                    location.reload();
                }
            });
        });

        //form
        var $name = $('#name'),
                $note = $('#note'),
                $addBtn = $('#addBtn');
        $addBtn.click(function () {
            var params = {
                name: $name.val(),
                note: $note.val() || 'add note...',
                completed: false
            };
            $.ajax({
                url: '/todos',
                method: 'post',
                data: params,
                success: function (r) {
                    alert('添加成功');
                    location.reload();
                }
            });
        })
    });
</script>
</body>
</html>


<!--<!DOCTYPE html>-->
<!--<html ng-app="app">-->
<!--<head>-->
<!--<title><%= title %></title>-->
<!--<link rel='stylesheet' href='/stylesheets/style.css'/>-->
<!--</head>-->
<!--<body>-->
<!--<h1><%= title %></h1>-->

<!--<ng-view></ng-view>-->

<!--&lt;!&ndash; Libraries &ndash;&gt;-->
<!--<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.25/angular.min.js"></script>-->
<!--<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.25/angular-route.min.js"></script>-->

<!--&lt;!&ndash; Template &ndash;&gt;-->
<!--<script type="text/ng-template" id="/todos.html">-->
<!--Search: <input type="text" ng-model="search.name">-->
<!--<ul>-->
<!--<li ng-repeat="todo in todos | filter: search">-->
<!--<input type="checkbox" ng-model="todo.completed">-->
<!--<a href="#/{{$index}}">{{todo.name}}</a>-->
<!--</li>-->
<!--</ul>-->
<!--</script>-->

<!--<script type="text/ng-template" id="/todoDetails.html">-->
<!--<h1>{{ todo.name }}</h1>-->
<!--completed: <input type="checkbox" ng-model="todo.completed">-->
<!--note: <textarea>{{ todo.note }}</textarea>-->
<!--</script>-->

<!--<script>-->
<!--angular.module('app', ['ngRoute'])-->

<!--//-&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->
<!--// Services-->
<!--//-&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->

<!--.factory('Todos', ['$http', function ($http) {-->
<!--return $http.get('/todos');-->
<!--}])-->

<!--//-&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->
<!--// Controllers-->
<!--//-&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->

<!--.controller('TodoController', ['$scope', 'Todos', function ($scope, Todos) {-->
<!--Todos.success(function (arr) {-->
<!--$scope.todos = arr;-->
<!--});-->
<!--}])-->

<!--.controller('TodoDetailCtrl', ['$scope', '$routeParams', 'Todos', function ($scope, $routeParams, Todos) {-->
<!--$scope.todo = Todos[$routeParams.id];-->
<!--}])-->

<!--//-&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->
<!--// Routes-->
<!--//-&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->

<!--.config(['$routeProvider', function ($routeProvider) {-->
<!--$routeProvider-->
<!--.when('/', {-->
<!--templateUrl: '/todos.html',-->
<!--controller: 'TodoController'-->
<!--})-->

<!--.when('/:id', {-->
<!--templateUrl: '/todoDetails.html',-->
<!--controller: 'TodoDetailCtrl'-->
<!--});-->
<!--}]);-->
<!--</script>-->
<!--</body>-->
<!--</html>-->